{% extends 'layout.html' %}

{% block title %}{{title}}{%endblock%}

{% block head %}
{% endblock %}

{% block content %}
<h3>主页</h3>
{% if userinfo %}<a href="/add">添加文章{% endif %}
<ul>
    {% for item in data %}
    <li>
        <a href="/article/{{ item._id.toString() }}">{{item.title||"无标题文章"}}</a>
        {% if userinfo %}
        <a href="javascript: ;" class="a-delete" data-id="{{item._id.toString()}}">删除文章</a>
        {% endif %}
    </li>
    {% endfor %}
</ul>
<script>
    $(document).on('click', '.a-delete', function(e) {
        if(!confirm("Y/N?")){ return false; }
        var id = $(this).attr('data-id');
        console.log(id);
        $.post('/aDelete', { id: id }, function(resp) {
            if(resp.status === 0){
              location.reload();
            }else{
              alert('删除失败~');
            }
        });
    });
</script>
{% endblock %}