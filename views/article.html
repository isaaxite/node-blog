{% extends 'layout.html' %}

{% block title %}{{title}}{%endblock%}

{% block head %}
<link rel="stylesheet" href="/statics/editor.md/css/editormd.preview.css" />
<style>
    #container{ width: 900px;margin: auto; }
    /*#container img{ width: 100%; }*/
    #article{ padding: 0; }
    .title{ font-size: 30px;line-height: 50px;font-weight: normal;margin: 0;padding: 0; }
    small{ line-height: 24px;color: #969696; }
    .a-edit{ position: absolute;right: 0;top: 0;line-height: 24px;color: currentColor; }
</style>
{% endblock %}

{% block content %}
<div id="container">
    <h3 class="title">{{data.title||"无标题文章"}}</h3>
    <div style="position: relative;">
        <small>Update At: {{data.updateAt|date('Y.m.d h:i')}}</small>
        {% if userinfo %}<a class="a-edit" href="/add/{{data._id.toString()}}">编辑文章</a>{% endif %}
    </div>
    <div id="article">
        <textarea style="display:none;" name="test-editormd-markdown-doc">{{data.markdown}}</textarea>
    </div>
</div>
<script src="/javascripts/jquery-1.11.1.min.js"></script>
<script src="/statics/editor.md/lib/marked.min.js"></script>
<script src="/statics/editor.md/lib/prettify.min.js"></script>

<script src="/statics/editor.md/lib/raphael.min.js"></script>
<script src="/statics/editor.md/lib/underscore.min.js"></script>
<script src="/statics/editor.md/lib/sequence-diagram.min.js"></script>
<script src="/statics/editor.md/lib/flowchart.min.js"></script>
<script src="/statics/editor.md/lib/jquery.flowchart.min.js"></script>

<script src="/statics/editor.md/editormd.min.js"></script>
<script>
  $(function() {
    editormd.markdownToHTML("article", {
      htmlDecode: "style,script,iframe",  // you can filter tags decode
      tocm: true,    // Using [TOCM]
      emoji: true,
      taskList: true,
      tex: true,  // 默认不解析
      flowChart: true,  // 默认不解析
      sequenceDiagram: true,  // 默认不解析
    });
  });
</script>
{% endblock %}